"use strict";(self.webpackChunkconnect_app=self.webpackChunkconnect_app||[]).push([[798],{4798:(dt,O,a)=>{a.r(O),a.d(O,{CommunicationModule:()=>ct});var d=a(6814),i=a(95),P=a(7700),g=a(5959),u=a(3788),x=a(4780),Z=a(8306),t=a(9468),h=a(7061),m=a(8962),_=a(676),f=a(8184);function y(e,c){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" (",n.updateCountdown,"s)")}}function T(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"button",13),t.NdJ("click",function(){t.CHM(n);const s=t.oxw(2);return t.KtG(s.deleteGroup(s.groupId))}),t._uU(1,"Delete Group"),t.qZA()}}const G=function(e,c){return{"own-message ":e," other-message":c}};function A(e,c){if(1&e&&(t.TgZ(0,"div",14)(1,"div",15)(2,"p",16),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"p",17),t._uU(6),t.qZA(),t.TgZ(7,"p",18),t._uU(8),t.qZA()()()),2&e){const n=c.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.WLB(7,G,n.authorID===o.userId,n.authorID!==o.userId)),t.xp6(2),t.Oqu(t.xi3(4,4,n.createdAt,"dd.MM.yy HH:mm")),t.xp6(3),t.Oqu(n.authorName),t.xp6(2),t.Oqu(n.message)}}const S=function(){return["/"]};function J(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div")(2,"a",2),t._uU(3,"< Back"),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.updateGroupMessages(s.groupId))}),t._uU(6,"Update "),t.YNc(7,y,2,1,"span",5),t.qZA(),t.YNc(8,T,2,0,"button",6),t.qZA(),t.TgZ(9,"div",7)(10,"div",8),t.YNc(11,A,9,10,"div",9),t.ALo(12,"async"),t.qZA(),t.TgZ(13,"div",10),t._UZ(14,"input",11),t.TgZ(15,"button",12),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.sendMessage(s.groupId))}),t._uU(16,"Send"),t.qZA()()()()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("routerLink",t.DdM(9,S)),t.xp6(3),t.Q6J("disabled",n.updateCountdown>0),t.xp6(2),t.Q6J("ngIf",n.updateCountdown>0),t.xp6(1),t.Q6J("ngIf",n.creatorId===n.userId),t.xp6(3),t.Q6J("ngForOf",t.lcZ(12,7,n.messages$)),t.xp6(2),t.Q6J("formGroup",n.newMessageForm),t.xp6(2),t.Q6J("disabled",n.newMessageForm.invalid)}}let F=(()=>{class e{constructor(n,o,s,r,p,l,v){this.groupService=n,this.route=o,this.router=s,this.modalService=r,this.store=p,this.fb=l,this.snackbarService=v,this.groupId=null,this.creatorId=null,this.userId=null,this.updateCountdown=0,this.newMessageForm=this.fb.group({newMessage:["",[i.kI.required]]})}ngOnInit(){this.userId=localStorage.getItem("uid")||"",this.groupId=this.route.snapshot.paramMap.get("groupID"),this.creatorId=this.groupService.getCreatorId(),this.groupId&&(this.store.dispatch(x.EV({groupID:this.groupId})),this.messages$=this.store.select(Z.a(this.groupId)))}sendMessage(n){const o=this.newMessageForm.value.newMessage;(new Date).getTime().toString(),n&&this.groupService.addMessage(n,o).subscribe(()=>{this.store.dispatch(x.EV({groupID:n})),this.newMessageForm.reset()})}deleteGroup(n){this.modalService.confirmationModalOpen("Are you sure you want to delete this group?").afterClosed().subscribe(s=>{s&&this.groupService.deleteGroup(n).subscribe(()=>{this.store.dispatch(u.BN({groupId:n})),this.router.navigate(["/"]),this.snackbarService.openSnackBar("Group deleted")})})}updateGroupMessages(n){if(0===this.updateCountdown){this.store.dispatch(x.EV({groupID:n})),this.updateCountdown=60;const o=setInterval(()=>{this.updateCountdown-=1,0===this.updateCountdown&&clearInterval(o)},1e3)}}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(h.l),t.Y36(g.gz),t.Y36(g.F0),t.Y36(m.Z),t.Y36(_.yh),t.Y36(i.qu),t.Y36(f.o))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-group-dialog"]],decls:1,vars:1,consts:[["class","dialog-wrapper",4,"ngIf"],[1,"dialog-wrapper"],[1,"back-link",3,"routerLink"],[1,"btn-container"],[1,"btn",3,"disabled","click"],[4,"ngIf"],["class","btn",3,"click",4,"ngIf"],[1,"group-dialog-container"],[1,"messages-container"],["class","message",4,"ngFor","ngForOf"],[1,"form-container",3,"formGroup"],["type","text","placeholder","Type your message...","formControlName","newMessage",1,"message-input"],[1,"btn","send-message-btn",3,"disabled","click"],[1,"btn",3,"click"],[1,"message"],[3,"ngClass"],[1,"message-date"],[1,"message-author"],[1,"message-text"]],template:function(o,s){1&o&&t.YNc(0,J,17,10,"div",0),2&o&&t.Q6J("ngIf",s.groupId)},dependencies:[d.mk,d.sg,d.O5,g.rH,i.Fj,i.JJ,i.JL,i.sg,i.u,d.Ov,d.uU],styles:[".dialog-wrapper[_ngcontent-%COMP%]{width:1200px;height:100%;margin:0 auto;padding:30px}.back-link[_ngcontent-%COMP%]{padding:20px;text-decoration:none;color:#000;cursor:pointer}.back-link[_ngcontent-%COMP%]:hover{color:#656565}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;padding:20px}.group-dialog-container[_ngcontent-%COMP%]{width:800px;height:80%;display:flex;flex-direction:column;margin:0 auto;background-color:#fff;box-shadow:0 2px 5px #0000001a}.messages-container[_ngcontent-%COMP%]{height:90%;display:flex;flex-direction:column;gap:10px;padding:20px;overflow:scroll;border-bottom:1px solid #656565}.form-container[_ngcontent-%COMP%]{height:10%;display:flex;justify-content:center;gap:10px;align-items:center}.message-input[_ngcontent-%COMP%]{width:50%;padding:10px;border:none;background-color:#f2f2f2;cursor:text}.message-input[_ngcontent-%COMP%]:focus{outline-color:#a5cea5}.btn[_ngcontent-%COMP%]{width:10%;padding:10px;border:none;text-transform:uppercase;background-color:#fff;box-shadow:0 2px 5px #0000001a;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#c5c5c5}.own-message[_ngcontent-%COMP%], .other-message[_ngcontent-%COMP%]{position:relative;max-width:70%;margin-bottom:10px;border-radius:10px;color:#000;padding:10px;box-shadow:0 5px 10px #0000001a}.own-message[_ngcontent-%COMP%]{float:right;display:flex;flex-direction:column;text-align:right;background-color:#a5cea5}.other-message[_ngcontent-%COMP%]{float:left;display:flex;flex-direction:column;text-align:left;background-color:#f2f2f2}.message-date[_ngcontent-%COMP%]{font-size:12px;color:#656565}.message-author[_ngcontent-%COMP%]{font-size:14px;color:#656565}.message-text[_ngcontent-%COMP%]{font-size:16px}.send-message-btn[_ngcontent-%COMP%]{background-color:#a5cea5}.send-message-btn[_ngcontent-%COMP%]:hover{background-color:#83a583}.dark[_nghost-%COMP%]   .group-dialog-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .group-dialog-container[_ngcontent-%COMP%]{background-color:#626262}.dark[_nghost-%COMP%]   .messages-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .messages-container[_ngcontent-%COMP%]{border-bottom:1px solid #f2f2f2}.dark[_nghost-%COMP%]   .own-message[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .own-message[_ngcontent-%COMP%]{background-color:#343566;color:#f2f2f2;box-shadow:0 5px 10px #ffffff1a}.dark[_nghost-%COMP%]   .other-message[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .other-message[_ngcontent-%COMP%]{background-color:#292929;color:#f2f2f2;box-shadow:0 5px 10px #ffffff1a}.dark[_nghost-%COMP%]   .message-date[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .message-date[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .message-author[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .message-author[_ngcontent-%COMP%]{color:#ababab}.dark[_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]:focus{outline-color:#343566}.dark[_nghost-%COMP%]   .back-link[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]{color:#f2f2f2}.dark[_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]:hover{color:#656565}.dark[_nghost-%COMP%]   .btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .btn[_ngcontent-%COMP%]{box-shadow:0 2px 5px #ffffff1a}.dark[_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]{background-color:#343566;color:#f2f2f2}.dark[_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]:hover{background-color:#1f204c}"]})}return e})();var L=a(4495);function U(e,c){1&e&&(t.TgZ(0,"div"),t._uU(1," Name is required. "),t.qZA())}function Y(e,c){1&e&&(t.TgZ(0,"div"),t._uU(1," Name should be less than 30 characters. "),t.qZA())}function D(e,c){1&e&&(t.TgZ(0,"div"),t._uU(1," Name should contain only letters, numbers, and spaces. "),t.qZA())}let N=(()=>{class e{constructor(n,o,s){this.dialogRef=n,this.fb=o,this.groupService=s,this.createGroupForm=this.fb.group({name:["",[i.kI.required,i.kI.maxLength(30),i.kI.pattern(/^[a-zA-Z\u0430-\u044f\u0410-\u042f0-9\s]+$/)]]})}onSubmit(){this.createGroupForm.invalid||this.groupService.createGroup(this.createGroupForm.value).subscribe(n=>{n&&this.dialogRef.close({submitted:!0,data:{name:this.createGroupForm.value,groupID:n.groupID}})})}onClose(){this.dialogRef.close({submitted:!1})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(P.so),t.Y36(i.qu),t.Y36(h.l))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-create-group-modal"]],decls:16,vars:5,consts:[[1,"modal-container"],[3,"formGroup","ngSubmit"],["matInput","","formControlName","name"],[4,"ngIf"],[1,"btns-container"],["type","button",3,"click"],["type","submit",3,"disabled"]],template:function(o,s){if(1&o&&(t.TgZ(0,"div",0)(1,"form",1),t.NdJ("ngSubmit",function(){return s.onSubmit()}),t.TgZ(2,"h2"),t._uU(3,"Create New Group"),t.qZA(),t.TgZ(4,"div")(5,"label"),t._uU(6,"Name: "),t.qZA(),t._UZ(7,"input",2),t.YNc(8,U,2,0,"div",3),t.YNc(9,Y,2,0,"div",3),t.YNc(10,D,2,0,"div",3),t.qZA(),t.TgZ(11,"div",4)(12,"button",5),t.NdJ("click",function(){return s.onClose()}),t._uU(13,"Close"),t.qZA(),t.TgZ(14,"button",6),t._uU(15,"Create"),t.qZA()()()()),2&o){let r,p,l;t.xp6(1),t.Q6J("formGroup",s.createGroupForm),t.xp6(7),t.Q6J("ngIf",(null==(r=s.createGroupForm.get("name"))?null:r.hasError("required"))&&(null==(r=s.createGroupForm.get("name"))?null:r.touched)),t.xp6(1),t.Q6J("ngIf",(null==(p=s.createGroupForm.get("name"))?null:p.hasError("maxlength"))&&(null==(p=s.createGroupForm.get("name"))?null:p.touched)),t.xp6(1),t.Q6J("ngIf",(null==(l=s.createGroupForm.get("name"))?null:l.hasError("pattern"))&&(null==(l=s.createGroupForm.get("name"))?null:l.touched)),t.xp6(4),t.Q6J("disabled",s.createGroupForm.invalid)}},dependencies:[d.O5,i._Y,i.Fj,i.JJ,i.JL,i.sg,i.u],styles:[".modal-container[_ngcontent-%COMP%]{width:100%;height:100%;position:fixed;top:0;left:0;background-color:#0000001a}form[_ngcontent-%COMP%]{width:400px;height:200px;margin:200px auto;display:flex;flex-direction:column;justify-content:center;gap:30px;padding:20px;text-align:center;background-color:#fff}.btns-container[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.btns-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{text-transform:uppercase;padding:10px;border:none;background-color:#d1cfcf;box-shadow:0 2px 5px #0000001a}.btns-container[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#a7a6a6}input[_ngcontent-%COMP%]{padding:10px}.dark[_nghost-%COMP%]   .modal-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .modal-container[_ngcontent-%COMP%]{background-color:#fff3}.dark[_nghost-%COMP%]   form[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   form[_ngcontent-%COMP%]{background-color:#292929}"]})}return e})();function q(e,c){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" (",n.updateCountdown,"s)")}}function Q(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"button",11),t.NdJ("click",function(){t.CHM(n);const s=t.oxw().$implicit,r=t.oxw();return t.KtG(r.deleteGroup(s.id))}),t._uU(1,"delete "),t.qZA()}}function B(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"div",8)(2,"a",9),t.NdJ("click",function(){const r=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.setCreatorId(r.createdBy))}),t._uU(3),t.ALo(4,"uppercase"),t.qZA(),t.YNc(5,Q,2,0,"button",10),t.qZA()()}if(2&e){const n=c.$implicit,o=t.oxw();t.xp6(2),t.Q6J("routerLink","/group/"+n.id),t.xp6(1),t.hij(" ",t.lcZ(4,3,n.name)," "),t.xp6(2),t.Q6J("ngIf",n.createdBy===o.userId)}}let j=(()=>{class e{constructor(n,o,s,r){this.store=n,this.groupService=o,this.modalService=s,this.snackbarService=r,this.updateCountdown=0,this.userId=localStorage.getItem("uid")||""}ngOnInit(){this.store.dispatch(u.tb()),this.groups$=this.store.select(L.pY)}setCreatorId(n){this.groupService.setCreatorId(n)}updateList(){if(0===this.updateCountdown){this.groupService.getGroupList().subscribe(o=>{const s=o.Items.map(r=>({id:r.id.S,name:r.name.S,createdAt:r.createdAt.S,createdBy:r.createdBy.S}));this.store.dispatch(u.JT({groups:s}))}),this.updateCountdown=60;const n=setInterval(()=>{this.updateCountdown-=1,0===this.updateCountdown&&clearInterval(n)},1e3)}}createGroup(){this.modalService.creationModalOpen(N).afterClosed().subscribe(o=>{if(o&&o.data){const s=o.data.name,r=o.data.groupID;this.snackbarService.openSnackBar("Group created"),this.store.dispatch(u.Rp({group:{id:r,name:s,createdAt:"",createdBy:this.userId}}))}})}deleteGroup(n){this.modalService.confirmationModalOpen("Are you sure you want to delete this group?").afterClosed().subscribe(s=>{s&&this.groupService.deleteGroup(n).subscribe(()=>{this.store.dispatch(u.BN({groupId:n})),this.snackbarService.openSnackBar("Group deleted")})})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(_.yh),t.Y36(h.l),t.Y36(m.Z),t.Y36(f.o))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-group-list"]],decls:12,vars:5,consts:[[1,"group-list-container"],[1,"list-title"],[1,"btns-container"],[1,"btn",3,"disabled","click"],[4,"ngIf"],[1,"btn",3,"click"],[1,"groups-list"],[4,"ngFor","ngForOf"],[1,"group-block"],[1,"group",3,"routerLink","click"],["class"," btn delete-btn","color","warn",3,"click",4,"ngIf"],["color","warn",1,"btn","delete-btn",3,"click"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Groups"),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return s.updateList()}),t._uU(5," Update "),t.YNc(6,q,2,1,"span",4),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return s.createGroup()}),t._uU(8,"Create"),t.qZA()(),t.TgZ(9,"div",6),t.YNc(10,B,6,5,"div",7),t.ALo(11,"async"),t.qZA()()),2&o&&(t.xp6(4),t.Q6J("disabled",s.updateCountdown>0),t.xp6(2),t.Q6J("ngIf",s.updateCountdown>0),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,3,s.groups$)))},dependencies:[d.sg,d.O5,g.rH,d.Ov,d.gd],styles:[".group-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:15px;height:100%;background-color:#fff;overflow:scroll}.list-title[_ngcontent-%COMP%]{text-align:right}.groups-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px;height:90%;overflow:scroll}.group-block[_ngcontent-%COMP%]{display:flex;justify-content:space-between;padding:10px;background-color:#f2f2f2}.group[_ngcontent-%COMP%]{text-decoration:none;color:#000;cursor:pointer}.btns-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;gap:10px;padding:10px}.btn[_ngcontent-%COMP%]{padding:10px;background-color:#d1cfcf;border:none;box-shadow:0 2px 5px #0000001a;text-transform:uppercase;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#a7a6a6}.delete-btn[_ngcontent-%COMP%]:hover{background-color:#cd6767}.dark[_nghost-%COMP%]   .group-list-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .group-list-container[_ngcontent-%COMP%]{background-color:#626262;box-shadow:0 2px 5px #fff3}.dark[_nghost-%COMP%]   .group-block[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .group-block[_ngcontent-%COMP%]{background-color:#292929;box-shadow:0 2px 5px #ffffff1a}.dark[_nghost-%COMP%]   .group[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .group[_ngcontent-%COMP%]{color:#fff}.dark[_nghost-%COMP%]   .btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .btn[_ngcontent-%COMP%]{box-shadow:0 2px 5px #ffffff1a}"]})}return e})();var k=a(2572),$=a(7398),H=a(8180),C=a(517),E=a(449),w=a(153),z=a(3810),I=a(5156),M=a(9064);function R(e,c){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw();t.xp6(1),t.hij(" (",n.updateCountdown,"s)")}}const K=function(e,c){return{companion:e,user:c}};function X(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div")(1,"div",7),t.NdJ("click",function(){const r=t.CHM(n).$implicit,p=t.oxw();return t.KtG(p.createConversation(r.uid))}),t._uU(2),t.ALo(3,"uppercase"),t.qZA()()}if(2&e){const n=c.$implicit,o=t.oxw();t.xp6(1),t.Q6J("ngClass",t.WLB(4,K,o.companions.includes(n.uid),!o.companions.includes(n.uid))),t.xp6(1),t.hij(" ",t.lcZ(3,2,n.name)," ")}}let V=(()=>{class e{constructor(n,o,s,r,p){this.router=n,this.peopleService=o,this.conversationService=s,this.store=r,this.snackbarService=p,this.companions=[],this.updateCountdown=0,this.userId=localStorage.getItem("uid")}ngOnInit(){(0,k.a)([this.store.dispatch(C.yV()),this.store.dispatch(w.p_())]),this.initData()}initData(){(0,k.a)([this.conversationList$=this.store.select(E.nX),this.people$=this.store.select(z.yw)]).subscribe(([n])=>{this.companions=n.map(o=>o.companionID.S)})}updateConversationList(){this.conversationService.getConversationsList().subscribe(n=>{this.store.dispatch(C.ho({conversations:n.Items}))})}updateUsersList(){this.peopleService.getPeopleList().subscribe(n=>{const o=n.Items.map(s=>({uid:s.uid.S,name:s.name.S}));this.store.dispatch(w.B_({users:o}))})}updateLists(){if(0===this.updateCountdown){this.updateConversationList(),this.updateUsersList(),this.updateCountdown=60;const n=setInterval(()=>{this.updateCountdown-=1,0===this.updateCountdown&&clearInterval(n)},1e3)}}createConversation(n){this.conversationList$.pipe((0,$.U)(s=>s.find(r=>r.companionID.S===n)),(0,H.q)(1)).subscribe(s=>{s?this.router.navigate(["/conversation",s.id.S]):this.conversationService.createConversation(n).subscribe(r=>{this.store.dispatch(C.V$({conversation:{id:{S:r.conversationID},companionID:{S:n}}})),this.router.navigate(["/conversation",r.conversationID]),this.snackbarService.openSnackBar("Conversation created")})})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(g.F0),t.Y36(I.g),t.Y36(M.E),t.Y36(_.yh),t.Y36(f.o))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-people-list"]],decls:10,vars:5,consts:[[1,"people-list-container"],[1,"list-title"],[1,"btn-container"],[1,"btn",3,"disabled","click"],[4,"ngIf"],[1,"users-list"],[4,"ngFor","ngForOf"],[3,"ngClass","click"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2,"Users"),t.qZA(),t.TgZ(3,"div",2)(4,"button",3),t.NdJ("click",function(){return s.updateLists()}),t._uU(5," Update "),t.YNc(6,R,2,1,"span",4),t.qZA()(),t.TgZ(7,"div",5),t.YNc(8,X,4,7,"div",6),t.ALo(9,"async"),t.qZA()()),2&o&&(t.xp6(4),t.Q6J("disabled",s.updateCountdown>0),t.xp6(2),t.Q6J("ngIf",s.updateCountdown>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(9,3,s.people$)))},dependencies:[d.mk,d.sg,d.O5,d.Ov,d.gd],styles:[".people-list-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;padding:15px;background-color:#fff;height:100%;overflow:scroll}.list-title[_ngcontent-%COMP%]{text-align:right}.users-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:10px;padding:10px;height:90%;overflow:scroll}.user[_ngcontent-%COMP%]{padding:10px;background-color:#f2f2f2;box-shadow:0 2px 5px #0000001a;cursor:pointer}.companion[_ngcontent-%COMP%]{padding:10px;background-color:#a5cea5;box-shadow:0 2px 5px #0000001a;cursor:pointer}.btn-container[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:flex-start;padding:10px}.btn[_ngcontent-%COMP%]{padding:10px;background-color:#d1cfcf;border:none;box-shadow:0 2px 5px #0000001a;text-transform:uppercase;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#a7a6a6}.dark[_nghost-%COMP%]   .people-list-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .people-list-container[_ngcontent-%COMP%]{background-color:#626262;box-shadow:0 2px 5px #fff3}.dark[_nghost-%COMP%]   .user[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .user[_ngcontent-%COMP%]{background-color:#292929;box-shadow:0 2px 5px #ffffff1a;color:#fff}.dark[_nghost-%COMP%]   .companion[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .companion[_ngcontent-%COMP%]{background-color:#343566;box-shadow:0 2px 5px #ffffff1a}.dark[_nghost-%COMP%]   .btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .btn[_ngcontent-%COMP%]{box-shadow:0 2px 5px #ffffff1a}"]})}return e})();const W=function(){return["/user/profile"]};let tt=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-main-page"]],decls:7,vars:2,consts:[[1,"main-wrapper"],[1,"link-wrapper"],[1,"profile-link",3,"routerLink"],[1,"main-container"]],template:function(o,s){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"a",2),t._uU(3,"My profile "),t.qZA()(),t.TgZ(4,"div",3),t._UZ(5,"app-group-list")(6,"app-people-list"),t.qZA()()),2&o&&(t.xp6(2),t.Q6J("routerLink",t.DdM(1,W)))},dependencies:[g.rH,j,V],styles:[".main-wrapper[_ngcontent-%COMP%]{width:100%;height:100%;margin-top:10px;display:flex;flex-direction:column;gap:10px}.link-wrapper[_ngcontent-%COMP%]{text-align:right}.main-container[_ngcontent-%COMP%]{height:95%;padding:20px;display:flex;gap:20px}app-group-list[_ngcontent-%COMP%], app-people-list[_ngcontent-%COMP%]{width:50%;height:100%;box-shadow:0 2px 5px #0000001a}.profile-link[_ngcontent-%COMP%]{padding:10px;color:#000;font-size:16px;background-color:#fff;box-shadow:0 2px 5px #0000001a;border:none;text-decoration:none;text-transform:uppercase;cursor:pointer}.profile-link[_ngcontent-%COMP%]:hover{background-color:#626262;color:#fff}.dark[_nghost-%COMP%]   .profile-link[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .profile-link[_ngcontent-%COMP%]{background-color:#626262;box-shadow:0 2px 5px #ffffff1a;color:#f2f2f2}.dark[_nghost-%COMP%]   .profile-link[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .profile-link[_ngcontent-%COMP%]:hover{background-color:#474747;color:#fff}"]})}return e})();var b=a(1713),nt=a(8635);function ot(e,c){if(1&e&&(t.TgZ(0,"span"),t._uU(1),t.qZA()),2&e){const n=t.oxw(2);t.xp6(1),t.hij(" (",n.updateCountdown,"s)")}}const et=function(e,c){return{"own-message":e,"other-message":c}};function st(e,c){if(1&e&&(t.TgZ(0,"div")(1,"div",13)(2,"p",14),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"p",15),t._uU(6),t.qZA(),t.TgZ(7,"p",16),t._uU(8),t.qZA()()()),2&e){const n=c.$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngClass",t.WLB(7,et,n.authorID===o.userId,n.authorID!==o.userId)),t.xp6(2),t.Oqu(t.xi3(4,4,n.createdAt,"dd.MM.yy HH:mm")),t.xp6(3),t.Oqu(n.authorName),t.xp6(2),t.Oqu(n.message)}}const rt=function(){return["/"]};function at(e,c){if(1&e){const n=t.EpF();t.TgZ(0,"div",1)(1,"div")(2,"a",2),t._uU(3,"< Back"),t.qZA()(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.updateConversationMessages(s.conversationId))}),t._uU(6,"Update "),t.YNc(7,ot,2,1,"span",5),t.qZA(),t.TgZ(8,"button",6),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.deleteConversation(s.conversationId))}),t._uU(9,"Delete Chat"),t.qZA()(),t.TgZ(10,"div",7)(11,"div",8),t.YNc(12,st,9,10,"div",9),t.ALo(13,"async"),t.qZA(),t.TgZ(14,"div",10),t._UZ(15,"input",11),t.TgZ(16,"button",12),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.sendMessage(s.conversationId))}),t._uU(17,"Send"),t.qZA()()()()}if(2&e){const n=t.oxw();t.xp6(2),t.Q6J("routerLink",t.DdM(8,rt)),t.xp6(3),t.Q6J("disabled",n.updateCountdown>0),t.xp6(2),t.Q6J("ngIf",n.updateCountdown>0),t.xp6(5),t.Q6J("ngForOf",t.lcZ(13,6,n.messages$)),t.xp6(2),t.Q6J("formGroup",n.newMessageForm),t.xp6(2),t.Q6J("disabled",n.newMessageForm.invalid)}}let it=(()=>{class e{constructor(n,o,s,r,p,l,v){this.conversationService=n,this.route=o,this.router=s,this.modalService=r,this.store=p,this.fb=l,this.snackbar=v,this.conversationId=null,this.userId=null,this.updateCountdown=0,this.newMessageForm=this.fb.group({newMessage:["",[i.kI.required]]})}ngOnInit(){this.userId=localStorage.getItem("uid")||"",this.conversationId=this.route.snapshot.paramMap.get("conversationID"),this.conversationId&&(this.store.dispatch(b.dY({conversationID:this.conversationId})),this.messages$=this.store.select(nt.g(this.conversationId)))}sendMessage(n){const o=this.newMessageForm.value.newMessage;(new Date).getTime().toString(),this.conversationService.addMessage(n,o).subscribe(()=>{this.store.dispatch(b.dY({conversationID:n})),this.newMessageForm.reset()})}updateConversationMessages(n){if(0===this.updateCountdown){this.store.dispatch(b.dY({conversationID:n})),this.updateCountdown=60;const o=setInterval(()=>{this.updateCountdown-=1,0===this.updateCountdown&&clearInterval(o)},1e3)}}deleteConversation(n){this.modalService.confirmationModalOpen("Are you sure you want to delete this conversation?").afterClosed().subscribe(s=>{s&&this.conversationService.deleteConversation(n).subscribe(()=>{this.store.dispatch(C.Ae({conversationId:n})),this.router.navigate(["/"]),this.snackbar.openSnackBar("Conversation deleted")})})}static#t=this.\u0275fac=function(o){return new(o||e)(t.Y36(M.E),t.Y36(g.gz),t.Y36(g.F0),t.Y36(m.Z),t.Y36(_.yh),t.Y36(i.qu),t.Y36(f.o))};static#n=this.\u0275cmp=t.Xpm({type:e,selectors:[["app-person-conversation"]],decls:1,vars:1,consts:[["class","dialog-wrapper",4,"ngIf"],[1,"dialog-wrapper"],[1,"back-link",3,"routerLink"],[1,"btn-container"],[1,"btn",3,"disabled","click"],[4,"ngIf"],[1,"btn",3,"click"],[1,"conversation-dialog-container"],[1,"messages-container"],[4,"ngFor","ngForOf"],[1,"form-container",3,"formGroup"],["type","text","placeholder","Type your message...","formControlName","newMessage",1,"message-input"],[1,"btn","send-message-btn",3,"disabled","click"],[3,"ngClass"],[1,"message-date"],[1,"message-author"],[1,"message-text"]],template:function(o,s){1&o&&t.YNc(0,at,18,9,"div",0),2&o&&t.Q6J("ngIf",s.conversationId)},dependencies:[d.mk,d.sg,d.O5,g.rH,i.Fj,i.JJ,i.JL,i.sg,i.u,d.Ov,d.uU],styles:[".dialog-wrapper[_ngcontent-%COMP%]{width:1200px;height:100%;margin:0 auto;padding:30px}.back-link[_ngcontent-%COMP%]{padding:20px;text-decoration:none;color:#000;cursor:pointer}.back-link[_ngcontent-%COMP%]:hover{color:#656565}.btn-container[_ngcontent-%COMP%]{display:flex;justify-content:center;gap:10px;padding:20px}.conversation-dialog-container[_ngcontent-%COMP%]{width:800px;height:80%;display:flex;flex-direction:column;margin:0 auto;background-color:#fff;box-shadow:0 2px 5px #0000001a}.messages-container[_ngcontent-%COMP%]{height:90%;display:flex;flex-direction:column;gap:10px;padding:20px;overflow:scroll;border-bottom:1px solid #656565}.form-container[_ngcontent-%COMP%]{height:10%;display:flex;justify-content:center;gap:10px;align-items:center}.message-input[_ngcontent-%COMP%]{width:50%;padding:10px;border:none;background-color:#f2f2f2;cursor:text}.message-input[_ngcontent-%COMP%]:focus{outline-color:#a5cea5}.btn[_ngcontent-%COMP%]{width:10%;padding:10px;border:none;text-transform:uppercase;background-color:#fff;box-shadow:0 2px 5px #0000001a;cursor:pointer}.btn[_ngcontent-%COMP%]:hover{background-color:#c5c5c5}.own-message[_ngcontent-%COMP%], .other-message[_ngcontent-%COMP%]{position:relative;max-width:70%;margin-bottom:10px;border-radius:10px;color:#000;padding:10px;box-shadow:0 5px 10px #0000001a}.own-message[_ngcontent-%COMP%]{float:right;display:flex;flex-direction:column;text-align:right;background-color:#a5cea5}.other-message[_ngcontent-%COMP%]{float:left;display:flex;flex-direction:column;text-align:left;background-color:#f2f2f2}.message-date[_ngcontent-%COMP%]{font-size:12px;color:#656565}.message-author[_ngcontent-%COMP%]{font-size:14px;color:#656565}.message-text[_ngcontent-%COMP%]{font-size:16px}.send-message-btn[_ngcontent-%COMP%]{background-color:#a5cea5}.send-message-btn[_ngcontent-%COMP%]:hover{background-color:#83a583}.dark[_nghost-%COMP%]   .conversation-dialog-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .conversation-dialog-container[_ngcontent-%COMP%]{background-color:#626262}.dark[_nghost-%COMP%]   .messages-container[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .messages-container[_ngcontent-%COMP%]{border-bottom:1px solid #f2f2f2}.dark[_nghost-%COMP%]   .own-message[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .own-message[_ngcontent-%COMP%]{background-color:#343566;color:#f2f2f2;box-shadow:0 5px 10px #ffffff1a}.dark[_nghost-%COMP%]   .other-message[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .other-message[_ngcontent-%COMP%]{background-color:#292929;color:#f2f2f2;box-shadow:0 5px 10px #ffffff1a}.dark[_nghost-%COMP%]   .message-date[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .message-date[_ngcontent-%COMP%], .dark[_nghost-%COMP%]   .message-author[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .message-author[_ngcontent-%COMP%]{color:#ababab}.dark[_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]:focus, .dark   [_nghost-%COMP%]   .message-input[_ngcontent-%COMP%]:focus{outline-color:#343566}.dark[_nghost-%COMP%]   .back-link[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]{color:#f2f2f2}.dark[_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .back-link[_ngcontent-%COMP%]:hover{color:#656565}.dark[_nghost-%COMP%]   .btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .btn[_ngcontent-%COMP%]{box-shadow:0 2px 5px #ffffff1a}.dark[_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%], .dark   [_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]{background-color:#343566;color:#f2f2f2}.dark[_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]:hover, .dark   [_nghost-%COMP%]   .send-message-btn[_ngcontent-%COMP%]:hover{background-color:#1f204c}"]})}return e})(),ct=(()=>{class e{static#t=this.\u0275fac=function(o){return new(o||e)};static#n=this.\u0275mod=t.oAB({type:e});static#o=this.\u0275inj=t.cJS({providers:[m.Z,M.E,h.l,I.g,f.o],imports:[d.ez,g.Bz.forChild([{path:"",component:tt},{path:"group/:groupID",component:F},{path:"conversation/:conversationID",component:it}]),P.Is,i.u5,i.UX,g.Bz]})}return e})()}}]);